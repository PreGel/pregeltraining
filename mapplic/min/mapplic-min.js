!function($){var t=function(){function t(){this.el=null,this.shift=6,this.drop=0,this.location=null,this.init=function(){var t=this;this.el=$("<div></div>").addClass("mapplic-tooltip"),this.close=$("<a></a>").addClass("mapplic-tooltip-close").attr("href","#").appendTo(this.el),this.close.on("click touchend",function(i){i.preventDefault(),$(".mapplic-active",h.el).attr("class","mapplic-clickable"),h.deeplinking&&h.deeplinking.clear(),h.o.zoom||b(.5,.5,1,600,"easeInOutCubic"),t.hide()}),this.image=$("<img>").addClass("mapplic-tooltip-image").hide().appendTo(this.el),this.title=$("<h4></h4>").addClass("mapplic-tooltip-title").appendTo(this.el),this.content=$("<div></div>").addClass("mapplic-tooltip-content").appendTo(this.el),this.desc=$("<div></div>").addClass("mapplic-tooltip-description").appendTo(this.content),this.orbitlink=$("<div></div>").attr("data-orbit-link","#").hide().appendTo(this.el),this.link=$('<a id="scrolldown">More</a>').addClass("mapplic-tooltip-link").attr("href","#").hide().appendTo(this.orbitlink),this.link.on("click touchend",function(t){t.preventDefault(),$("html, body").animate({scrollTop:$("#locations").offset().top-200},1e3)}),this.triangle=$("<div></div>").addClass("mapplic-tooltip-triangle").prependTo(this.el),h.map.append(this.el)},this.set=function(t){if(t){var i=this;t.image?this.image.attr("src",t.image).show():this.image.hide(),t.link&&this.link.attr("href",t.link).show(),t.orbitlink?this.orbitlink.attr("data-orbit-link",t.orbitlink).show():this.link.hide(),this.title.text(t.title),this.desc.html(t.description),this.content[0].scrollTop=0,this.position(t)}},this.show=function(t){if(t){if("none"==t.action)return void this.el.stop().fadeOut(300);var i=this;this.location=t,h.hovertip.hide(),t.image?this.image.attr("src",t.image).show():this.image.hide(),t.link?this.link.attr("href",t.link).show():this.link.hide(),this.title.text(t.title),this.desc.html(t.description);var e=$('.mapplic-pin[data-location="'+t.id+'"]');0==e.length?this.shift=20:this.shift=e.height()+10,$("img",this.el).load(function(){i.position()}),this.position(),this.el.stop().show()}},this.position=function(){if(this.location){var t=h.map.offset().left+h.map.width()*this.location.x-h.container.offset().left,i=h.map.offset().top+h.map.height()*this.location.y-h.container.offset().top,e=100*this.location.x,a=100*this.location.y,n=-this.el.outerHeight()-this.shift,o=-this.el.outerWidth()/2;if(h.o.smartip){var l=.5;Math.abs(n)>i?(n=10,this.el.addClass("mapplic-bottom")):this.el.removeClass("mapplic-bottom"),this.el.outerWidth()/2>t?l=.5-(this.el.outerWidth()/2-t)/this.el.outerWidth():h.container.width()-t-this.el.outerWidth()/2<0&&(l=.5+(t+this.el.outerWidth()/2-h.container.width())/this.el.outerWidth()),l=Math.max(0,Math.min(1,l)),o=-this.el.outerWidth()*l,this.triangle.css("left",Math.max(5,Math.min(95,100*l))+"%")}this.el.css({left:e+"%",top:a+"%",marginTop:n,marginLeft:o}),this.drop=240+this.shift}},this.hide=function(){var t=this;this.location=null,this.el.stop().fadeOut(300,function(){t.desc.empty()})}}function i(){this.el=null,this.shift=6,this.init=function(){var t=this;this.el=$("<div></div>").addClass("mapplic-tooltip mapplic-hovertip"),this.title=$("<h4></h4>").addClass("mapplic-tooltip-title").appendTo(this.el),this.triangle=$("<div></div>").addClass("mapplic-tooltip-triangle").appendTo(this.el),$(h.map).on("mouseover",".mapplic-layer a",function(){var i="";$(this).hasClass("mapplic-pin")?(i=$(this).data("location"),t.shift=$(this).height()+10):(i=$(this).attr("xlink:href").slice(1),t.shift=20);var e=u(i);e&&t.show(e)}).on("mouseout",function(){t.hide()}),h.o.selector&&$(h.map).on("mouseover",h.o.selector,function(){var i=u($(this).attr("id"));t.shift=20,i&&t.show(i)}).on("mouseout",function(){t.hide()}),h.map.append(this.el)},this.show=function(t){h.tooltip.location!=t&&(this.title.text(t.title),this.position(t),this.el.stop().fadeIn(100))},this.position=function(t){var i=h.map.offset().left+h.map.width()*t.x-h.container.offset().left,e=h.map.offset().top+h.map.height()*t.y-h.container.offset().top,a=100*t.x,n=100*t.y,o=-this.el.outerHeight()-this.shift,l=0,s=.5;Math.abs(o)>e?(o=10,this.el.addClass("mapplic-bottom")):this.el.removeClass("mapplic-bottom"),this.el.outerWidth()/2>i?s=.5-(this.el.outerWidth()/2-i)/this.el.outerWidth():h.container.width()-i-this.el.outerWidth()/2<0&&(s=.5+(i+this.el.outerWidth()/2-h.container.width())/this.el.outerWidth()),l=-this.el.outerWidth()*s,this.triangle.css("left",Math.max(10,Math.min(90,100*s))+"%"),this.el.css({left:a+"%",top:n+"%",marginTop:o,marginLeft:l})},this.hide=function(){this.el.stop().fadeOut(200)}}function e(){this.param="location",this.init=function(){var t=this;this.check(0),window.onpopstate=function(i){return i.state&&t.check(600),!1}},this.check=function(t){var i=this.getUrlParam(this.param);f(i,t,!0)},this.getUrlParam=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)"),e=i.exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))},this.update=function(t){var i=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+this.param+"="+t;window.history.pushState({path:i},"",i)},this.clear=function(){history.pushState("",document.title,window.location.pathname)}}function a(){this.param="location",this.init=function(){var t=this;this.check(0),$(window).on("hashchange",function(){t.check(600)})},this.check=function(t){var i=location.hash.slice(this.param.length+2);f(i,t,!0)},this.update=function(t){window.location.hash=this.param+"-"+t},this.clear=function(){window.location.hash=this.param}}function n(){this.el=null,this.opacity=null,this.init=function(){this.el=$("<div></div>").addClass("mapplic-minimap").appendTo(h.container),this.el.css("height",this.el.width()*h.hw_ratio),this.el.click(function(t){t.preventDefault();var i=(t.pageX-$(this).offset().left)/$(this).width(),e=(t.pageY-$(this).offset().top)/$(this).height();b(i,e,h.scale/h.fitscale,100)})},this.addLayer=function(t){var i=$("<div></div>").addClass("mapplic-minimap-layer").addClass(t.id).appendTo(this.el);$("<img>").attr("src",t.minimap).addClass("mapplic-minimap-background").appendTo(i),$("<div></div>").addClass("mapplic-minimap-overlay").appendTo(i),$("<img>").attr("src",t.minimap).addClass("mapplic-minimap-active").appendTo(i)},this.show=function(t){$(".mapplic-minimap-layer",this.el).hide(),$(".mapplic-minimap-layer."+t,this.el).show()},this.update=function(t,i){var e=$(".mapplic-minimap-active",this.el);void 0===t&&(t=h.x),void 0===i&&(i=h.y);var a=Math.round(h.container.width()/h.contentWidth/h.scale*this.el.width()),n=Math.round(h.container.height()/h.contentHeight/h.scale*this.el.height()),o=Math.round(-i/h.contentHeight/h.scale*this.el.height()),l=Math.round(-t/h.contentWidth/h.scale*this.el.width()),s=l+a,c=o+n;e.each(function(){$(this)[0].style.clip="rect("+o+"px, "+s+"px, "+c+"px, "+l+"px)"});var p=this;this.el.show(),this.el.css("opacity",1),clearTimeout(this.opacity),this.opacity=setTimeout(function(){p.el.css("opacity",0),setTimeout(function(){p.el.hide()},600)},2e3)}}function o(){this.el=null,this.list=null,this.init=function(){var t=this;if(this.el=$("<div></div>").addClass("mapplic-sidebar").appendTo(h.el),h.o.search){var i=$("<form></form>").addClass("mapplic-search-form").submit(function(){return!1}).appendTo(this.el);h.clear=$("<button></button>").addClass("mapplic-search-clear").click(function(){e.val(""),e.keyup()}).appendTo(i);var e=$("<input>").attr({type:"text",spellcheck:"false",placeholder:"Search..."}).addClass("mapplic-search-input").keyup(function(){var i=$(this).val();t.search(i)}).prependTo(i)}var a=$("<div></div>").addClass("mapplic-list-container").appendTo(this.el);this.list=$("<ol></ol>").addClass("mapplic-list").appendTo(a),this.notfound=$("<p></p>").addClass("mapplic-not-found").text("Nothing found. Please try a different search.").appendTo(a),h.o.search||a.css("padding-top","0")},this.addCategories=function(t){var i=this.list;t&&$.each(t,function(t,e){var a=$("<li></li>").addClass("mapplic-list-category").attr("data-category",e.id),n=$("<ol></ol>").css("border-color",e.color).appendTo(a);"false"==e.show?n.hide():a.addClass("mapplic-opened");var o=$("<a></a>").attr("href","#").attr("title",e.title).css("background-color",e.color).text(e.title).prependTo(a);o.on("click",function(t){t.preventDefault(),a.toggleClass("mapplic-opened"),n.slideToggle(200)}),e.icon&&$("<img>").attr("src",e.icon).addClass("mapplic-list-thumbnail").prependTo(o),$("<span></span>").text("0").addClass("mapplic-list-count").prependTo(o),i.append(a)})},this.addLocation=function(t){var i=$("<li></li>").addClass("mapplic-list-location").addClass("mapplic-list-shown"),e=$("<a></a>").attr("href","#").click(function(i){i.preventDefault(),f(t.id,600),$(window).width()<668&&$("html, body").animate({scrollTop:h.container.offset().top},400)}).appendTo(i);t.thumbnail&&$("<img>").attr("src",t.thumbnail).addClass("mapplic-list-thumbnail").appendTo(e),$("<h4></h4>").text(t.title).appendTo(e),$("<span></span>").html(t.about).appendTo(e);var a=$('.mapplic-list-category[data-category="'+t.category+'"]');a.length?$("ol",a).append(i):this.list.append(i),$(".mapplic-list-count",a).text($(".mapplic-list-shown",a).length)},this.search=function(t){t?h.clear.fadeIn(100):h.clear.fadeOut(100),$(".mapplic-list li",h.el).each(function(){$(this).text().search(new RegExp(t,"i"))<0?($(this).removeClass("mapplic-list-shown"),$(this).slideUp(200)):($(this).addClass("mapplic-list-shown"),$(this).show())}),$(".mapplic-list > li",h.el).each(function(){var t=$(".mapplic-list-shown",this).length;$(".mapplic-list-count",this).text(t)}),$(".mapplic-list > li.mapplic-list-shown").length>0?this.notfound.fadeOut(200):this.notfound.fadeIn(200)}}function l(){this.el=null,this.init=function(){this.el=$("<div></div>").addClass("mapplic-coordinates").appendTo(h.container),this.el.append("x: "),$("<code></code>").addClass("mapplic-coordinates-x").appendTo(this.el),this.el.append(" y: "),$("<code></code>").addClass("mapplic-coordinates-y").appendTo(this.el),$(".mapplic-layer",h.map).on("mousemove",function(t){var i=(t.pageX-h.map.offset().left)/h.map.width(),e=(t.pageY-h.map.offset().top)/h.map.height();$(".mapplic-coordinates-x").text(parseFloat(i).toFixed(4)),$(".mapplic-coordinates-y").text(parseFloat(e).toFixed(4))})}}function s(){this.el=null,this.init=function(){this.el=$("<a></a>").attr("href","#").addClass("mapplic-clear-button").appendTo(h.container),this.el.on("click touchstart",function(t){t.preventDefault(),h.deeplinking&&h.deeplinking.clear(),$(".mapplic-active",h.el).attr("class","mapplic-clickable"),h.tooltip.hide(),b(.5,.5,1,400,"easeInOutCubic")})}}function c(){this.el=null,this.init=function(){this.el=$("<div></div>").addClass("mapplic-zoom-buttons").appendTo(h.container),this.zoomin=$("<a></ha>").attr("href","#").addClass("mapplic-zoomin-button").appendTo(this.el),this.zoomin.on("click touchstart",function(t){t.preventDefault();var i=h.scale;h.scale=w(i+.8*i),h.x=v(h.x-(h.container.width()/2-h.x)*(h.scale/i-1)),h.y=g(h.y-(h.container.height()/2-h.y)*(h.scale/i-1)),k(h.x,h.y,h.scale,400,"easeInOutCubic")}),this.zoomout=$("<a></ha>").attr("href","#").addClass("mapplic-zoomout-button").appendTo(this.el),this.zoomout.on("click touchstart",function(t){t.preventDefault();var i=h.scale;h.scale=w(i-.4*i),h.x=v(h.x-(h.container.width()/2-h.x)*(h.scale/i-1)),h.y=g(h.y-(h.container.height()/2-h.y)*(h.scale/i-1)),k(h.x,h.y,h.scale,400,"easeInOutCubic")})},this.update=function(t){this.zoomin.removeClass("mapplic-disabled"),this.zoomout.removeClass("mapplic-disabled"),t==h.fitscale?this.zoomout.addClass("mapplic-disabled"):t==h.o.maxscale&&this.zoomin.addClass("mapplic-disabled")}}function p(){this.el=null,this.init=function(){var t=this;this.element=h.el[0],$("<a></a>").attr("href","#").attr("href","#").addClass("mapplic-fullscreen-button").click(function(i){i.preventDefault(),t.isFull()?t.exitFull():t.goFull()}).appendTo(h.container)},this.goFull=function(){this.element.requestFullscreen?this.element.requestFullscreen():this.element.mozRequestFullScreen?this.element.mozRequestFullScreen():this.element.webkitRequestFullscreen?this.element.webkitRequestFullscreen():this.element.msRequestFullscreen&&this.element.msRequestFullscreen()},this.exitFull=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},this.isFull=function(){return window.innerHeight==screen.height?!0:!1}}var h=this;h.o={source:"locations.json",selector:"[id^=landmarks] > *",landmark:null,mapfill:!1,height:420,markers:!0,minimap:!0,sidebar:!0,search:!0,deeplinking:!0,clearbutton:!0,zoombuttons:!0,hovertip:!0,smartip:!0,fullscreen:!1,developer:!1,maxscale:4,skin:"",zoom:!0},h.init=function(t,i){return h.o=$.extend(h.o,i),h.x=0,h.y=0,h.scale=1,h.el=t.addClass("mapplic-element mapplic-loading").addClass(h.o.skin).height(h.o.height),h.o.landmark&&(h.o.sidebar=!1,h.o.zoombuttons=!1,h.o.deeplinking=!1),"string"==typeof h.o.source?$.getJSON(h.o.source,function(t){d(t),h.el.removeClass("mapplic-loading")}).fail(function(){console.error("Couldn't load map data. (Make sure you are running the script through a server and not just opening the html file with your browser)"),h.el.removeClass("mapplic-loading").addClass("mapplic-error"),alert("Data file missing or invalid!")}):(d(h.o.source),h.el.removeClass("mapplic-loading")),h};var d=function(d){h.data=d;var C=0,y;if(h.container=$("<div></div>").addClass("mapplic-container").appendTo(h.el),h.map=$("<div></div>").addClass("mapplic-map").appendTo(h.container),h.o.zoom&&h.map.addClass("mapplic-zoomable"),h.levelselect=$("<select></select>").addClass("mapplic-levels-select"),h.o.sidebar||h.container.css("width","100%"),h.contentWidth=parseInt(d.mapwidth),h.contentHeight=parseInt(d.mapheight),h.hw_ratio=d.mapheight/d.mapwidth,h.map.css({width:d.mapwidth,height:d.mapheight}),h.o.minimap&&(h.minimap=new n,h.minimap.init()),h.o.sidebar&&(h.sidebar=new o,h.sidebar.init(),h.sidebar.addCategories(d.categories)),d.levels&&$.each(d.levels,function(t,i){var e=i.map,a=e.substr(e.lastIndexOf(".")+1).toLowerCase(),n=$("<div></div>").addClass("mapplic-layer").addClass(i.id).hide().appendTo(h.map);switch(a){case"jpg":case"jpeg":case"png":case"gif":$("<img>").attr("src",e).addClass("mapplic-map-image").appendTo(n);break;case"svg":$("<div></div>").addClass("mapplic-map-image").load(e,function(){$(h.o.selector,this).each(function(){var t=u($(this).attr("id"));t&&($(this).attr("class","mapplic-clickable"),t.onmap=$(this),t.fill&&($(this).css("fill",t.fill),$("path",this).css("fill",t.fill)),h.o.landmark===t.id&&$(this).attr("class","mapplic-active"))}),$(h.o.selector).on("click touchend",function(){if(!h.dragging){var t=$(this).attr("id");f(t,600)}}),$("svg a",this).each(function(){var t=u($(this).attr("xlink:href").substr(1));t&&($(this).attr("class","mapplic-clickable"),t.onmap=$(this))}),$("svg a",this).click(function(t){var i=$(this).attr("xlink:href").substr(1);f(i,600),t.preventDefault()})}).appendTo(n);break;default:alert("File type "+a+" is not supported!")}h.minimap&&h.minimap.addLayer(i),h.levelselect.prepend($("<option></option>").attr("value",i.id).text(i.title)),(!y||i.show)&&(y=i.id),$.each(i.locations,function(t,i){var e=100*i.y,a=100*i.x;if("hidden"!=i.pin&&h.o.markers){var o="#",l=$("<a></a>").attr("href",o).addClass("mapplic-pin").css({top:e+"%",left:a+"%"}).appendTo(n);l.on("click touchend",function(t){t.preventDefault(),f(i.id,600)}),i.fill&&l.css("background-color",i.fill),l.attr("data-location",i.id),l.addClass(i.pin)}h.sidebar&&h.sidebar.addLocation(i)}),C++}),h.tooltip=new t,h.tooltip.init(),h.o.hovertip&&(h.hovertip=new i,h.hovertip.init()),h.o.developer&&(h.devtools=(new l).init()),h.o.clearbutton&&(h.clearbutton=(new s).init()),h.o.zoombuttons&&(h.zoombuttons=new c,h.zoombuttons.init(),h.o.clearbutton||h.zoombuttons.el.css("bottom","0")),h.o.fullscreen&&(h.fullscreen=(new p).init()),C>1){h.levels=$("<div></div>").addClass("mapplic-levels");var x=$('<a href="#"></a>').addClass("mapplic-levels-up").appendTo(h.levels);h.levelselect.appendTo(h.levels);var T=$('<a href="#"></a>').addClass("mapplic-levels-down").appendTo(h.levels);h.container.append(h.levels),h.levelselect.change(function(){var t=$(this).val();m(t)}),x.click(function(t){t.preventDefault(),$(this).hasClass("mapplic-disabled")||m("+")}),T.click(function(t){t.preventDefault(),$(this).hasClass("mapplic-disabled")||m("-")})}m(y),$(window).resize(function(){$(window).width()<668?h.container.height($(window).height()-66):h.container.height("100%");var t=h.container.width()/h.contentWidth,i=h.container.height()/h.contentHeight;h.o.mapfill?t>i?h.fitscale=t:h.fitscale=i:i>t?h.fitscale=t:h.fitscale=i,h.scale=w(h.scale),h.x=v(h.x),h.y=g(h.y),k(h.x,h.y,h.scale,100)}).resize(),h.o.landmark?f(h.o.landmark,0):b(.5,.5,1,0),h.o.deeplinking&&(history.pushState?h.deeplinking=new e:h.deeplinking=new a,h.deeplinking.init()),h.o.zoom&&r()},r=function(){var t=h.map,i=$(".mapplic-map-image",h.map);if(document.ondragstart=function(){return!1},i.on("mousedown",function(i){h.dragging=!1,t.stop(),t.data("mouseX",i.pageX),t.data("mouseY",i.pageY),t.data("lastX",h.x),t.data("lastY",h.y),t.addClass("mapplic-dragging"),h.map.on("mousemove",function(i){h.dragging=!0;var e=i.pageX-t.data("mouseX")+h.x;y=i.pageY-t.data("mouseY")+h.y,e=v(e),y=g(y),k(e,y),t.data("lastX",e),t.data("lastY",y)}),$(document).on("mouseup",function(i){h.x=t.data("lastX"),h.y=t.data("lastY"),h.map.off("mousemove"),$(document).off("mouseup"),t.removeClass("mapplic-dragging")})}),$(document).on("dblclick",".mapplic-map-image",function(t){t.preventDefault();var i=h.scale;h.scale=w(2*i),h.x=v(h.x-(t.pageX-h.container.offset().left-h.x)*(h.scale/i-1)),h.y=g(h.y-(t.pageY-h.container.offset().top-h.y)*(h.scale/i-1)),k(h.x,h.y,h.scale,400,"easeInOutCubic")}),!("ontouchstart"in window||"onmsgesturechange"in window))return!0;i.on("touchstart",function(e){h.dragging=!1;var a=e.originalEvent,n=t.position();t.data("touchY",a.changedTouches[0].pageY-n.top),t.data("touchX",a.changedTouches[0].pageX-n.left),i.on("touchmove",function(e){e.preventDefault(),h.dragging=!0;var a=e.originalEvent,n=a.touches.length;1==n?(h.x=v(a.changedTouches[0].pageX-t.data("touchX")),h.y=g(a.changedTouches[0].pageY-t.data("touchY")),k(h.x,h.y,h.scale,50)):i.off("touchmove")}),i.on("touchend",function(t){i.off("touchmove touchend")})});var e=new Hammer(h.map[0],{transform_always_block:!0,drag_block_horizontal:!0,drag_block_vertical:!0});h.map.on("touchstart",function(t){t.originalEvent.touches.length>1&&e.get("pinch").set({enable:!0})}),h.map.on("touchend",function(t){e.get("pinch").set({enable:!1})});var a=1,n;e.on("pinchstart",function(t){h.dragging=!1,a=h.scale/h.fitscale,n=a}),e.on("pinch",function(t){h.dragging=!0,1!=t.scale&&(a=Math.max(1,Math.min(n*t.scale,100)));var i=h.scale;h.scale=w(a*h.fitscale),h.x=v(h.x-(t.center.x-h.container.offset().left-h.x)*(h.scale/i-1)),h.y=g(h.y-(t.center.y-h.y)*(h.scale/i-1)),k(h.x,h.y,h.scale,100)})},m=function(t,i){switch(t){case"+":t=$("option:selected",h.levelselect).removeAttr("selected").prev().prop("selected","selected").val();break;case"-":t=$("option:selected",h.levelselect).removeAttr("selected").next().prop("selected","selected").val();break;default:$('option[value="'+t+'"]',h.levelselect).prop("selected","selected")}var e=$(".mapplic-layer."+t,h.map);if(!e.is(":visible")){i||h.tooltip.hide(),$(".mapplic-layer:visible",h.map).hide(),e.show(),h.minimap&&h.minimap.show(t);var a=h.levelselect.get(0).selectedIndex,n=$(".mapplic-levels-up",h.levels),o=$(".mapplic-levels-down",h.levels);n.removeClass("mapplic-disabled"),o.removeClass("mapplic-disabled"),0==a?n.addClass("mapplic-disabled"):a==h.levelselect.get(0).length-1&&o.addClass("mapplic-disabled")}},u=function(t){var i=null;return $.each(h.data.levels,function(e,a){$.each(a.locations,function(e,a){a.id==t&&(i=a)})}),i},f=function(t,i,e){$.each(h.data.levels,function(a,n){return n.id==t?(m(n.id,!1),!1):void $.each(n.locations,function(a,o){if(o.id==t){if("open-link"==o.action)return window.location.href=o.link,!1;if("open-link-new-tab"==o.action)return window.open(o.link),!1;var l=.5;h.o.landmark||(h.tooltip.set(o),h.tooltip.show(o),l=((h.container.height()-h.tooltip.drop)/2+h.tooltip.drop)/h.container.height());var s="undefined"!=typeof o.zoom?o.zoom:4;return m(n.id,!0),b(o.x,o.y,s,i,"easeInOutCubic",l),$(".mapplic-active",h.el).attr("class","mapplic-clickable"),o.onmap&&o.onmap.attr("class","mapplic-active"),h.o.deeplinking&&!e&&h.deeplinking.update(t),!1}})})},v=function(t){var i=h.container.width()-h.contentWidth*h.scale;return 0>i?t>0?t=0:i>t&&(t=i):t=i/2,t},g=function(t){var i=h.container.height()-h.contentHeight*h.scale;return 0>i?t>=0?t=0:i>t&&(t=i):t=i/2,t},w=function(t){return t<h.fitscale?t=h.fitscale:t>h.o.maxscale&&(t=h.o.maxscale),h.zoombuttons&&h.zoombuttons.update(t),t},b=function(t,i,e,a,n,o){a="undefined"!=typeof a?a:400,o="undefined"!=typeof o?o:.5,h.scale=w(h.fitscale*e),h.x=v(.5*h.container.width()-h.scale*h.contentWidth*t),h.y=g(h.container.height()*o-h.scale*h.contentHeight*i),k(h.x,h.y,h.scale,a,n)},k=function(t,i,e,a,n){void 0!==e?h.map.stop().animate({left:t,top:i,width:h.contentWidth*e,height:h.contentHeight*e},a,n,function(){h.tooltip&&h.tooltip.position()}):h.map.css({left:t,top:i}),h.tooltip&&h.tooltip.position(),h.minimap&&h.minimap.update(t,i)}};$.fn.mapplic=function(i){var e=this.length;return this.each(function(a){var n=$(this),o="mapplic"+(e>1?"-"+ ++a:""),l=(new t).init(n,i)})}}(jQuery);